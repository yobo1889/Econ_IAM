<!DOCTYPE html>
<html>
  <head>
    <title>Integrated Assessment Model</title>
    <meta charset="utf-8" />
  </head>
  <body>
    <p>Integrated Assessment Model</p>
    <pre id="content" style="white-space: pre-wrap;"></pre>

    <script type="text/javascript">
      const API_KEY = 'AIzaSyCV5ia_3Wy_Ab4IpoB3rb4kSkfdW3_msxQ';
      const DISCOVERY_DOC = 'https://sheets.googleapis.com/$discovery/rest?version=v4';
      const SPREADSHEET_ID = '1d8zUH-JMpL3NZ4QUswsM9fNKd8h8Pzt7-QNbv3WtUpc';
      const RANGES = ['Output!B2:B282', 'Output!C2:C282', 'Output!D2:D282'];

      function gapiLoaded() {
        gapi.load('client', initializeGapiClient);
      }

      async function initializeGapiClient() {
        try {
          await gapi.client.init({
            apiKey: API_KEY,
            discoveryDocs: [DISCOVERY_DOC],
          });
          listValues();
        } catch (error) {
          console.error("Error initializing the Google API client:", error);
          document.getElementById('content').innerText = 'Error loading data.';
        }
      }

      async function listValues() {
        let combinedData = [];
        try {
          for (let range of RANGES) {
            let response = await gapi.client.sheets.spreadsheets.values.get({
              spreadsheetId: SPREADSHEET_ID,
              range: range,
            });
            let values = response.result.values;
            if (!values || values.length === 0) {
              console.log('No values found for range:', range);
              continue;
            }
            combinedData.push(values.map(row => row[0]).join('\n'));
          }
          document.getElementById('content').innerText = combinedData.join('\n');
        } catch (err) {
          console.error("Error fetching data:", err);
          document.getElementById('content').innerText = 'Error fetching data.';
        }
      }
    </script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
  </body>
</html>
